- name: install_deps
  service: install
  command: npm install --quiet
- type: parallel
  steps:
    - name: unit_tests
      service: test
      command: npm run test
    - name: linting
      service: test
      command: node_modules/.bin/eslint build/ client/ server/ test/ --ext js,vue -c .eslintrc.json --color --cache --cache-location .eslintcache --ignore-path .eslintignore
- name: prod_build
  tag: ^(master|dev)
  service: build
  command: "scripts/build-prod.sh"
- name: aws_deploy
  tag: master
  service: deploy
  command: codeship_aws eb_deploy /tmp/deploy codeship-docker-test codeship-docker-test-env fyreapp-cache
